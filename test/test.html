<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<script data-main="requireConfig" src="ext/require.js"
	type="text/javascript"></script>
<script type="text/javascript">
  require([ "chai" ], function(chai) {
    var expect = chai.expect;

    require([ "ioc!b" ], function(b) {
      expect(b).to.be.a("object");

      // num = 1 (b is a singleton)
      expect(b.num).to.equal(1);

      expect(b.d).to.be.a("object");
    });

    require([ "ioc!c" ], function(c) {
      expect(c).to.be.a("object");
      expect(c.file).to.be.a("string");
      expect(c.file).to.equal("text");
      expect(c.string).to.be.a("string");
      expect(c.string).to.equal("blabla");
      expect(c.number).to.be.a("number");
    });

    require([ "ioc!a" ], function(a) {
      expect(a).to.be.a("object");

      expect(a.b).to.be.a("object");

      // num = 1 (b is a singleton)
      expect(a.b.num).to.equal(1);

      expect(a.b.d).to.be.a("object");
      expect(a.b.d.string).to.equal("titi");

      expect(a.c).to.be.a("object");

      expect(a.e).to.be.a("object");

      // num = 1 (first init for e)
      expect(a.e.num).to.equal(1);

      expect(a.e.string).to.equal("tata");

      // change string of d
      a.b.d.string = "tutu";
      expect(a.b.d.string).to.equal("tutu");

      // change string of e
      a.e.string = "tete";
      expect(a.e.string).to.equal("tete");

      require([ "ioc!d" ], function(d) {
        expect(d).to.be.a("object");
        // text has changed (d is a singleton)
        expect(d.string).to.equal("tutu");
      });

      require([ "ioc!e" ], function(e) {
        expect(e).to.be.a("object");
        // text has not changed (e is a prototype)
        expect(e.string).to.equal("tata");
        // num = 2 (e is a prototype)
        expect(e.num).to.equal(2);
      });

    });

    require([ "ioc!b" ], function(b) {
      expect(b).to.be.a("object");

      // num = 1 (b is a singleton)
      expect(b.num).to.equal(1);

      expect(b.d).to.be.a("object");
    });
  });
</script>
</head>
<body>
</body>
</html>